<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Mis Presupuestos</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <!-- Buscador -->
  <div class="buscador-wrapper">
    <div class="buscador">
      <span class="search-icon">ğŸ”</span>
      <input
        type="text"
        [(ngModel)]="busqueda"
        (ngModelChange)="filtrarPresupuestos()"
        placeholder="Buscar por cliente..."
        class="input-busqueda"
      />
    </div>
  </div>

  <!-- Badge Total Borradores -->
  <div class="borradores-badge">
    <span class="borradores-icono">ğŸ“‹</span>
    <span class="borradores-texto">Total de Borradores</span>
    <span class="borradores-count">{{ totalBorradores }}</span>
  </div>

  <!-- Lista de Presupuestos -->
  <div class="lista-presupuestos">
    <div
      class="card-presupuesto"
      *ngFor="let presupuesto of presupuestosFiltrados"
    >
      <!-- Cabecera de la Card -->
      <div class="card-header">
        <div class="card-info">
          <div class="cliente-row">
            <span class="doc-icono">ğŸ“„</span>
            <span class="cliente-nombre">{{ presupuesto.cliente }}</span>
          </div>
          <span class="fecha-creacion"
            >{{ formatearFecha(presupuesto.fecha) }}</span
          >
        </div>
        <div class="card-total">
          <span class="total-monto"
            >${{ getTotalPresupuesto(presupuesto).toFixed(2) }}</span
          >
          <span class="total-items"
            >{{ getTotalItems(presupuesto) }} items</span
          >
        </div>
      </div>

      <!-- Items -->
      <div class="card-items">
        <p class="items-titulo">Items:</p>
        <ul class="items-lista">
          <li *ngFor="let item of presupuesto.items" class="item-linea">
            â€¢ {{ item.descripcion }} â€” ${{ item.precio | number:'1.2-2' }}
          </li>
        </ul>
      </div>

      <!-- Acciones -->
      <div class="card-acciones">
        <div class="acciones-fila-1">
          <button
            class="btn btn-editar"
            (click)="editarPresupuesto(presupuesto)"
          >
            <span class="btn-icono">âœï¸</span> Editar
          </button>
          <button class="btn btn-pdf" (click)="descargarPDF(presupuesto)">
            <span class="btn-icono">â¬‡ï¸</span> PDF
          </button>
        </div>
        <div class="acciones-fila-2">
          <button
            class="btn btn-whatsapp"
            (click)="compartirWhatsApp(presupuesto)"
          >
            <span class="btn-icono">ğŸ”—</span> WhatsApp
          </button>
          <button
            class="btn btn-eliminar"
            (click)="eliminarPresupuesto(presupuesto)"
          >
            <span class="btn-icono">ğŸ—‘ï¸</span> Eliminar
          </button>
        </div>
      </div>
    </div>

    <!-- Estado vacÃ­o -->
    <div class="empty-state" *ngIf="presupuestosFiltrados.length === 0">
      <p>No se encontraron presupuestos.</p>
    </div>
  </div>
</ion-content>
